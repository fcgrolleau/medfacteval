<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>MedAgentBrief Pilot</title>
    <style> body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; margin: 0; padding: 20px; line-height: 1.5; }
    .top-controls { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    #copy-button { background-color: #0077aa; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-size: 14px; transition: background-color 0.2s; }
    #copy-button:hover { background-color: #005f88; }
    .toggle-container { display: flex; align-items: center; } .label-text { margin-left: 10px; font-size: 16px; } .switch { position: relative; display: inline-block; width: 60px; height: 34px; } .switch input { opacity: 0; width: 0; height: 0; } .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; -webkit-transition: .4s; transition: .4s; } .slider:before { position: absolute; content: ""; height: 26px; width: 26px; left: 4px; bottom: 4px; background-color: white; -webkit-transition: .4s; transition: .4s; } input:checked + .slider { background-color: #0077aa; } input:focus + .slider { box-shadow: 0 0 1px #0077aa; } input:checked + .slider:before { -webkit-transform: translateX(26px); -ms-transform: translateX(26px); transform: translateX(26px); } .slider.round { border-radius: 34px; } .slider.round:before { border-radius: 50%; }
    .notice { background-color: #fffbe6; border-left: 5px solid #ffc107; padding: 15px 20px; margin-bottom: 25px; }
    .notice strong { color: #b36e00; }
    .notice a { color: #0056b3; font-weight: bold; text-decoration: underline; }
    .citation { cursor: pointer; position: relative; color: #0077aa; text-decoration: none; vertical-align: baseline; font-size: 75%; top: -0.5em; }
    body.no-citations .citation { display: none; }
    .citation .tooltip { visibility: hidden; white-space: pre-wrap; background-color: #f9f9f9; border: 1px solid #ccc; padding: 15px; width: 650px; max-width: 90vw; max-height: 70vh; overflow-y: auto; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); z-index: 9999; position: absolute; top: 25px; left: 0; }
    .citation:hover .tooltip { visibility: visible; }
    .citation .tooltip.tooltip-left { left: auto; right: 0; }
    .citation:hover::after { content: ""; } </style>
</head>
<body>
<div class="top-controls">
    <div class="toggle-container">
        <label class="switch">
            <input type="checkbox" id="citation-toggle" checked>
            <span class="slider round"></span>
        </label>
        <span class="label-text">Show Citations</span>
    </div>
    <button id="copy-button">Copy to Clipboard</button>
</div>
<div class="notice"><strong>Supplementary Data 1:</strong> Anonymized sample of a MedAgentBrief-generated summary (HTML format).</div>
<div id="summary-content"><br/><strong>One-Liner:</strong><br/> [Mr. anonymized name] is an [anonymized age] years old male with a history of a [anonymized chronic viral infection] (intermittently compliant with therapy), substance use disorder, and prior upper gastrointestinal bleeding, admitted for [gastrointestinal bleeding symptom] and [substance withdrawal syndrome].<br/> <br/> <strong>Brief Hospital Course:</strong><br/> [Mr. anonymized name] was admitted for [gastrointestinal bleeding symptom] and [substance withdrawal syndrome] in the context of heavy substance use and a history of a [anonymized gastrointestinal condition]. He was managed for withdrawal with [anonymized withdrawal medications] in the emergency department, followed by additional medications for autonomic symptoms. Supportive care included [anonymized nutritional supplements] and telemetry monitoring. His withdrawal symptoms improved, with minimal tremor on last exam, though he continued to experience some tremors and temperature fluctuations. There was no recurrence of gastrointestinal bleeding; hemoglobin remained stable. He was restarted on his [anonymized antiretroviral therapy] and remained compliant during admission. Nutritional assessment identified significant malnutrition and risk for refeeding syndrome, prompting initiation of oral nutrition supplementation, micronutrient support, and close electrolyte monitoring. Additional issues addressed included episodes of loss of consciousness (with normal neurological exam and improving headache), elevated white blood cell count (improved without evidence of infection), and an [anonymized metabolic condition] (managed with fluids and supplements). On the last hospital day, he was hemodynamically stable, alert, and oriented, with resolution of acute symptoms. The patient and family agreed to transfer to an [anonymized unit] at an [anonymized hospital]. No additional case management needs were identified.<sup class="citation">†<span class="tooltip">Note Date: [anonymized date]<br/> Note Content:<br/> Patient Name : [anonymized name] MRN : [anonymized MRN] Date of Birth : [anonymized date] , Age : [anonymized age] Y Room Number: [anonymized room number] Date of Admission : [anonymized date] Primary Care Provider and Contact (if available) : [anonymized PCP info] [anonymized institution] Hospital Medicine Inpatient Progress Note Date of Service: [anonymized date] Service : [anonymized service] Attending Provider : [Dr. anonymized name] MD Treatment Team and Phone Number : [anonymized team info] ID: [Mr. anonymized name] is an [anonymized age] Y male with Hx of [anonymized chronic viral infection] intermittently compliant with therapy, [substance use disorder] with prior admissions for withdrawal and UGIB with prior [anonymized procedure] showing [anonymized gastrointestinal condition], presenting with [gastrointestinal bleeding symptom] and [substance withdrawal syndrome]. [removed section for anonymization]</span></sup><br/> <br/> <strong>Outstanding Issues / Follow-Up:</strong><br/>
Ongoing need for substance use disorder treatment and relapse prevention ([Substance Withdrawal Syndrome])<br/>
Monitor for recurrent gastrointestinal bleeding; GI consult if symptoms recur (Upper Gastrointestinal Bleed)<br/>
Pending repeat viral load and CD4 count results ([Anonymized Chronic Viral Infection])<br/>
Ongoing risk for refeeding syndrome; continue close monitoring (Malnutrition and Refeeding Risk)<br/>
Pending [anonymized follow-up labs]<sup class="citation">†<span class="tooltip">Note Date: [anonymized date]<br/> Note Content:<br/> Patient Name : [anonymized name] MRN : [anonymized MRN] Date of Birth : [anonymized date] , Age : [anonymized age] Y Room Number: [anonymized room number] Date of Admission : [anonymized date] Primary Care Provider and Contact (if available) : [anonymized PCP info] [anonymized institution] Hospital Medicine Inpatient Progress Note Date of Service: [anonymized date] Service : [anonymized service] Attending Provider : [Dr. anonymized name] MD Treatment Team and Phone Number : [anonymized team info] ID: [Mr. anonymized name] is an [anonymized age] Y male with Hx of [anonymized chronic viral infection] intermittently compliant with therapy, [substance use disorder] with prior admissions for withdrawal and UGIB with prior [anonymized procedure] showing [anonymized gastrointestinal condition], presenting with [gastrointestinal bleeding symptom] and [substance withdrawal syndrome]. [removed section for anonymization]</span></sup> ([Anonymized Metabolic Condition])<br/> <strong><br/> Problem #1 - [Substance Withdrawal Syndrome]</strong><br/> <br/>• <em>Key Diagnostics & Results:</em><br/>
CIWA scores monitored; initial CIWA [anonymized score].<br/>
No evidence of withdrawal seizures or delirium tremens.<br/>
Addiction medicine consulted.<br/> <br/>• <em>Therapeutic Procedures:</em><br/>
Managed with [anonymized withdrawal medications].<sup class="citation">†<span class="tooltip">Note Date: [anonymized date]<br/> Note Content:<br/> Patient Name : [anonymized name] MRN : [anonymized MRN] Date of Birth : [anonymized date] , Age : [anonymized age] Y Room Number: [anonymized room number] Date of Admission : [anonymized date] Primary Care Provider and Contact (if available) : [anonymized PCP info] [anonymized institution] Hospital Medicine Inpatient Progress Note Date of Service: [anonymized date] Service : [anonymized service] Attending Provider : [Dr. anonymized name] MD Treatment Team and Phone Number : [anonymized team info] ID: [Mr. anonymized name] is an [anonymized age] Y male with Hx of [anonymized chronic viral infection] intermittently compliant with therapy, [substance use disorder] with prior admissions for withdrawal and UGIB with prior [anonymized procedure] showing [anonymized gastrointestinal condition], presenting with [gastrointestinal bleeding symptom] and [substance withdrawal syndrome]. [removed section for anonymization]</span></sup><br/>
Supportive care with [anonymized nutritional supplements] and telemetry.<br/> <br/>• <em>Current Status:</em><br/>
Withdrawal symptoms improved; minimal tremor on last exam; some tremors and temperature fluctuations persist, no hallucinations.<sup class="citation">†<span class="tooltip">Note Date: [anonymized date]<br/> Note Content:<br/> Patient Name : [anonymized name] MRN : [anonymized MRN] Date of Birth : [anonymized date] , Age : [anonymized age] Y Room Number: [anonymized room number] Date of Admission : [anonymized date] Primary Care Provider and Contact (if available) : [anonymized PCP info] [anonymized institution] Hospital Medicine Inpatient Progress Note Date of Service: [anonymized date] Service : [anonymized service] Attending Provider : [Dr. anonymized name] MD Treatment Team and Phone Number : [anonymized team info] ID: [Mr. anonymized name] is an [anonymized age] Y male with Hx of [anonymized chronic viral infection] intermittently compliant with therapy, [substance use disorder] with prior admissions for withdrawal and UGIB with prior [anonymized procedure] showing [anonymized gastrointestinal condition], presenting with [gastrointestinal bleeding symptom] and [substance withdrawal syndrome]. [removed section for anonymization]</span></sup><br/> <br/>• <em>Discharge Plan & Goals:</em><br/>
Continue substance cessation efforts; outpatient addiction medicine follow-up.<br/>
Continue [anonymized nutritional supplements].<br/> <br/>• <em>Outstanding / Pending Issues:</em><br/>
Ongoing need for substance use disorder treatment and relapse prevention.<br/> <strong><br/> Problem #2 - Upper Gastrointestinal Bleed (UGIB) due to [Anonymized Gastrointestinal Condition]</strong><br/> <br/>• <em>Key Diagnostics & Results:</em><br/>
History of [anonymized gastrointestinal condition] on prior [anonymized procedure] ([anonymized date]).<br/>
Hemoglobin stable ([anonymized value] g/dL during admission), improved from prior admissions.<sup class="citation">†<span class="tooltip">Note Date: [anonymized date]<br/> Note Content:<br/> Patient Name : [anonymized name] MRN : [anonymized MRN] Date of Birth : [anonymized date] , Age : [anonymized age] Y Room Number: [anonymized room number] Date of Admission : [anonymized date] Primary Care Provider and Contact (if available) : [anonymized PCP info] [anonymized institution] Hospital Medicine Inpatient Progress Note Date of Service: [anonymized date] Service : [anonymized service] Attending Provider : [Dr. anonymized name] MD Treatment Team and Phone Number : [anonymized team info] ID: [Mr. anonymized name] is an [anonymized age] Y male with Hx of [anonymized chronic viral infection] intermittently compliant with therapy, [substance use disorder] with prior admissions for withdrawal and UGIB with prior [anonymized procedure] showing [anonymized gastrointestinal condition], presenting with [gastrointestinal bleeding symptom] and [substance withdrawal syndrome]. [removed section for anonymization]</span></sup><br/>
H. pylori stool antigen negative ([anonymized date]).<br/> <br/>• <em>Therapeutic Procedures:</em><br/>
IV [anonymized proton pump inhibitor].<br/>
IV fluids for volume support.<br/>
Regular diet as tolerated.<sup class="citation">†<span class="tooltip">Note Date: [anonymized date]<br/> Note Content:<br/> Patient Name : [anonymized name] MRN : [anonymized MRN] Date of Birth : [anonymized date] , Age : [anonymized age] Y Room Number: [anonymized room number] Date of Admission : [anonymized date] Primary Care Provider and Contact (if available) : [anonymized PCP info] [anonymized institution] Hospital Medicine Inpatient Progress Note Date of Service: [anonymized date] Service : [anonymized service] Attending Provider : [Dr. anonymized name] MD Treatment Team and Phone Number : [anonymized team info] ID: [Mr. anonymized name] is an [anonymized age] Y male with Hx of [anonymized chronic viral infection] intermittently compliant with therapy, [substance use disorder] with prior admissions for withdrawal and UGIB with prior [anonymized procedure] showing [anonymized gastrointestinal condition], presenting with [gastrointestinal bleeding symptom] and [substance withdrawal syndrome]. [removed section for anonymization]</span></sup><br/> <br/>• <em>Current Status:</em><br/>
No further hematemesis or melena; hemodynamically stable.<br/> <br/>• <em>Discharge Plan & Goals:</em><br/>
Continue proton pump inhibitor therapy.<br/>
Avoid NSAIDs and alcohol.<br/> <br/>• <em>Outstanding / Pending Issues:</em><br/>
Monitor for recurrent gastrointestinal bleeding; GI consult if symptoms recur.<br/> <strong><br/> Problem #3 - [Anonymized Chronic Viral Infection]</strong><br/> <br/>• <em>Key Diagnostics & Results:</em><br/>
Prior detectable viral loads with nonadherence; most recent CD4 count normal.<br/>
Positive viral load on [anonymized date] (VL [anonymized value]), and on [anonymized date] (VL [anonymized value]); undetectable on [anonymized date].<sup class="citation">†<span class="tooltip">Note Date: [anonymized date]<br/> Note Content:<br/> Patient Name : [anonymized name] MRN : [anonymized MRN] Date of Birth : [anonymized date] , Age : [anonymized age] Y Room Number: [anonymized room number] Date of Admission : [anonymized date] Primary Care Provider and Contact (if available) : [anonymized PCP info] [anonymized institution] Hospital Medicine Inpatient Progress Note Date of Service: [anonymized date] Service : [anonymized service] Attending Provider : [Dr. anonymized name] MD Treatment Team and Phone Number : [anonymized team info] ID: [Mr. anonymized name] is an [anonymized age] Y male with Hx of [anonymized chronic viral infection] intermittently compliant with therapy, [substance use disorder] with prior admissions for withdrawal and UGIB with prior [anonymized procedure] showing [anonymized gastrointestinal condition], presenting with [gastrointestinal bleeding symptom] and [substance withdrawal syndrome]. [removed section for anonymization]</span></sup><br/>
No evidence of opportunistic infection during this admission.<br/> <br/>• <em>Therapeutic Procedures:</em><br/>
Restarted on [anonymized antiretroviral therapy].<br/> <br/>• <em>Current Status:</em><br/>
Clinically stable; compliant with therapy during admission.<br/> <br/>• <em>Discharge Plan & Goals:</em><br/>
Continue [anonymized antiretroviral therapy].<br/>
Outpatient follow-up with infectious diseases.<br/> <br/>• <em>Outstanding / Pending Issues:</em><br/>
Pending repeat viral load and CD4 count results.<br/> <br/> <strong>Relevant Medical History:</strong><br/>
[Anonymized chronic viral infection] (diagnosed [anonymized date], intermittently compliant with therapy)<br/>
Substance use disorder with multiple prior admissions<br/>
[Anonymized gastrointestinal condition] on prior [anonymized procedure]<br/>
History of [anonymized liver condition]<br/>
[Anonymized cardiac finding] on prior ECG<br/>
[Anonymized psychiatric condition]<br/>
[Substance use history]<br/>
[Anonymized cardiovascular condition] (inconsistent use of [anonymized antihypertensive medication])<br/> <br/> <strong>Relevant Surgical History:</strong><br/>
[Anonymized procedure] on [anonymized date] for evaluation of upper gastrointestinal bleeding</div>
<script>
document.getElementById('citation-toggle').addEventListener('change', function() {
    if (this.checked) {
        document.body.classList.remove('no-citations');
    } else {
        document.body.classList.add('no-citations');
    }
});

// Helper function to provide visual feedback on the copy button.
function showCopiedMessage() {
    const copyButton = document.getElementById('copy-button');
    if (!copyButton) return;
    const originalText = copyButton.innerText;
    copyButton.innerText = 'Copied!';
    setTimeout(function() {
        copyButton.innerText = originalText;
    }, 2000);
}

document.getElementById('copy-button').addEventListener('click', function() {
    const summaryEl = document.getElementById('summary-content');
    const tempEl = summaryEl.cloneNode(true);
    tempEl.querySelectorAll('.citation').forEach(function(citation) {
        citation.remove();
    });
    // Get HTML and plain text for clipboard
    const htmlToCopy = tempEl.innerHTML;
    const textToCopy = tempEl.innerText;
    // Use Clipboard API to copy both HTML and plain text.
    // The pasting application will choose the richest format it supports.
    if (navigator.clipboard && window.ClipboardItem) {
        const blobHtml = new Blob([htmlToCopy], { type: 'text/html' });
        const blobText = new Blob([textToCopy], { type: 'text/plain' });
        const clipboardItem = new ClipboardItem({
            'text/html': blobHtml,
            'text/plain': blobText
        });
        navigator.clipboard.write([clipboardItem]).then(showCopiedMessage).catch(err => {
            // Fallback to plain text if the rich text copy fails
            console.error('Rich text copy failed, falling back to plain text:', err);
            navigator.clipboard.writeText(textToCopy).then(showCopiedMessage);
        });
    } else {
        // Fallback for older browsers: plain text only
        navigator.clipboard.writeText(textToCopy).then(showCopiedMessage);
    }
});

document.addEventListener('DOMContentLoaded', function() {
    const citations = document.querySelectorAll('.citation');
    citations.forEach(function(citation) {
        citation.addEventListener('mouseover', function() {
            const tooltip = this.querySelector('.tooltip');
            if (!tooltip) return;
            const citationRect = this.getBoundingClientRect();
            const viewportWidth = window.innerWidth;
            if (citationRect.left > viewportWidth / 2) {
                tooltip.classList.add('tooltip-left');
            } else {
                tooltip.classList.remove('tooltip-left');
            }
        });
    });
});
</script>
</body>
</html>